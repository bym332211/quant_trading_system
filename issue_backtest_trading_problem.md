# å›æµ‹äº¤æ˜“é—®é¢˜ï¼šåªæœ‰2024å¹´æ‰æœ‰äº¤æ˜“

## é—®é¢˜æè¿°

åœ¨è¿è¡Œé‡åŒ–äº¤æ˜“å›æµ‹æ—¶ï¼Œå‘ç°åªæœ‰2024å¹´æ‰æœ‰äº¤æ˜“è®°å½•ï¼Œ2020-2023å¹´æ²¡æœ‰äº¤æ˜“ã€‚å…·ä½“è¡¨ç°ä¸ºï¼š

- **å›æµ‹æ—¶é—´èŒƒå›´**: 2020-01-01 åˆ° 2024-12-31
- **å®é™…äº¤æ˜“å¹´ä»½**: åªæœ‰2024å¹´æœ‰äº¤æ˜“ï¼ˆ7198ä¸ªè®¢å•ï¼‰
- **é¢„æœŸè¡Œä¸º**: æ‰€æœ‰å¹´ä»½ï¼ˆ2020-2024ï¼‰éƒ½åº”è¯¥æœ‰äº¤æ˜“

## å·²æ’æŸ¥äº‹é¡¹

### âœ… æ•°æ®å®Œæ•´æ€§æ£€æŸ¥
- [x] é¢„æµ‹æ•°æ®æ–‡ä»¶ `preds_y5_2020_2024.parquet` åŒ…å«2020-2024å¹´å®Œæ•´æ•°æ®
- [x] å„å¹´ä»½æ•°æ®åˆ†å¸ƒå‡åŒ€ï¼ˆ2020:124927, 2021:125635, 2022:125480, 2023:125209, 2024:126997ï¼‰
- [x] æ•°æ®å‡†å¤‡é˜¶æ®µæ²¡æœ‰è¿‡æ»¤ä»»ä½•å¹´ä»½çš„æ•°æ®

### âœ… æ‰§è¡Œæ—¥æœŸç”Ÿæˆæ£€æŸ¥  
- [x] å‘¨é¢‘è°ƒåº¦å‡½æ•° `weekly_schedule` å·¥ä½œæ­£å¸¸
- [x] å…¨å¹´éƒ½æœ‰æ­£ç¡®çš„æ‰§è¡Œæ—¥æœŸï¼ˆ53ä¸ªæ‰§è¡Œæ—¥/å¹´ï¼‰
- [x] æ‰§è¡Œæ—¥æœŸèŒƒå›´æ­£ç¡®ï¼ˆ2020-01-02 åˆ° 2024-12-28ï¼‰

### âœ… ç­–ç•¥é€»è¾‘æ£€æŸ¥
- [x] å•ç‹¬æµ‹è¯•å„æœˆä»½ï¼ˆ1æœˆã€6æœˆã€12æœˆï¼‰éƒ½æœ‰äº¤æ˜“
- [x] ç­–ç•¥å‚æ•°é…ç½®æ­£ç¡®ï¼ˆtop_k=50, membership_buffer=0.35ç­‰ï¼‰
- [x] ç­–ç•¥æƒé‡è®¡ç®—é€»è¾‘æ­£å¸¸

### âœ… æ•°æ®å‡†å¤‡æ£€æŸ¥
- [x] æ•°æ®å‡†å¤‡å‡½æ•° `prepare_predictions` æ²¡æœ‰è¿‡æ»¤æ•°æ®
- [x] æ—¶é—´æˆ³æ ¼å¼æ­£ç¡®ï¼Œè¾¹ç•Œæ£€æŸ¥é€šè¿‡
- [x] æ‰€æœ‰å¹´ä»½æ•°æ®åœ¨å‡†å¤‡åéƒ½å®Œæ•´ä¿ç•™

## æœªæ’æŸ¥äº‹é¡¹ / å¯ç–‘ç‚¹

### ğŸ” æ‰§è¡Œæ—¥æœŸæ˜ å°„é—®é¢˜
- [ ] æ£€æŸ¥ `asof_map_schedule_to_pred` å‡½æ•°çš„æ˜ å°„é€»è¾‘
- [ ] éªŒè¯è°ƒåº¦æ—¥åˆ°é¢„æµ‹æ—¥çš„æ˜ å°„å‡†ç¡®æ€§
- [ ] è°ƒè¯•æ˜ å°„è¿‡ç¨‹ä¸­æ˜¯å¦å­˜åœ¨å¹´ä»½ä¸åŒ¹é…

### ğŸ” æ•°æ®åŠ è½½æ—¶åºé—®é¢˜
- [ ] æ£€æŸ¥ä»·æ ¼æ•°æ®åŠ è½½æ—¶åºï¼ˆQLibæ•°æ®å¯èƒ½å­˜åœ¨é—®é¢˜ï¼‰
- [ ] éªŒè¯é”šå®šç¬¦å·ï¼ˆSPYï¼‰çš„äº¤æ˜“æ—¥æœŸå®Œæ•´æ€§
- [ ] æ£€æŸ¥æ‰§è¡Œå»¶è¿Ÿï¼ˆexec_lagï¼‰å‚æ•°çš„å½±å“

### ğŸ” ç­–ç•¥æ‰§è¡Œç¯å¢ƒé—®é¢˜
- [ ] æ£€æŸ¥å›æµ‹å¼•æ“çš„å…¨å±€çŠ¶æ€ç®¡ç†
- [ ] éªŒè¯ç­–ç•¥å®ä¾‹æ˜¯å¦åœ¨ä¸åŒå¹´ä»½é—´æ­£ç¡®é‡ç½®
- [ ] è°ƒè¯•æƒé‡å¹³æ»‘å‚æ•°çš„å½±å“

### ğŸ” æ•°æ®ç‰¹å¾é—®é¢˜
- [ ] æ£€æŸ¥ç‰¹å¾æ•°æ®ï¼ˆfeatures_day.parquetï¼‰çš„å®Œæ•´æ€§
- [ ] éªŒè¯ä¸­æ€§åŒ–å¤„ç†ï¼ˆbeta,sectorï¼‰æ˜¯å¦å½±å“é€‰è‚¡
- [ ] åˆ†ææ³¢åŠ¨ç‡é™åˆ¶å¯¹äº¤æ˜“çš„å½±å“

## ##TODO

### ä¸‹ä¸€æ­¥è°ƒæŸ¥å†…å®¹

1. **è°ƒè¯•æ‰§è¡Œæ—¥æœŸæ˜ å°„**
   - åœ¨ `prepare_execution_dates` å‡½æ•°ä¸­æ·»åŠ è¯¦ç»†è°ƒè¯•è¾“å‡º
   - æ£€æŸ¥æ¯ä¸ªæ‰§è¡Œæ—¥æœŸæ˜ å°„åˆ°çš„é¢„æµ‹æ—¥æœŸ
   - éªŒè¯æ˜¯å¦å­˜åœ¨å¹´ä»½è·³è·ƒæˆ–é”™è¯¯æ˜ å°„

2. **æ£€æŸ¥QLibæ•°æ®åŠ è½½**
   - éªŒè¯2020-2023å¹´çš„ä»·æ ¼æ•°æ®æ˜¯å¦å¯ç”¨
   - æ£€æŸ¥é”šå®šç¬¦å·SPYåœ¨å„å¹´ä»½çš„äº¤æ˜“æ—¥æœŸ
   - ç¡®è®¤æ•°æ®åŠ è½½æ²¡æœ‰æ—¶åºé—®é¢˜

3. **åˆ†æç­–ç•¥çŠ¶æ€ç®¡ç†**
   - æ£€æŸ¥ç­–ç•¥å®ä¾‹æ˜¯å¦åœ¨å¹´ä»½é—´æ­£ç¡®é‡ç½®
   - éªŒè¯å¹³æ»‘å‚æ•°æ˜¯å¦å¯¼è‡´æƒé‡ç¼“æ…¢å˜åŒ–
   - è°ƒè¯•ç­–ç•¥çš„åˆå§‹çŠ¶æ€è®¾ç½®

4. **å®Œæ•´å›æµ‹æµç¨‹è·Ÿè¸ª**
   - æ·»åŠ ç«¯åˆ°ç«¯çš„è°ƒè¯•è¾“å‡ºï¼Œè·Ÿè¸ªä»æ•°æ®å‡†å¤‡åˆ°äº¤æ˜“æ‰§è¡Œçš„å®Œæ•´æµç¨‹
   - è®°å½•æ¯ä¸ªæ‰§è¡Œæ—¥çš„é€‰è‚¡ç»“æœå’Œæƒé‡è®¡ç®—
   - æ¯”è¾ƒä¸åŒå¹´ä»½çš„æ‰§è¡Œæ—¥å¿—å·®å¼‚

### è°ƒæŸ¥æ–¹æ³•

```python
# ç¤ºä¾‹è°ƒè¯•ä»£ç  - æ·»åŠ åˆ° prepare_execution_dates å‡½æ•°
print(f"æ‰§è¡Œæ—¥æœŸæ˜ å°„è¯¦ç»†æ£€æŸ¥:")
for sched_date, pred_date in sched2pred.items():
    year_match = "âœ…" if sched_date.year == pred_date.year else "âŒ"
    print(f"  {year_match} è°ƒåº¦æ—¥: {sched_date} -> é¢„æµ‹æ—¥: {pred_date}")
    if sched_date.year != pred_date.year:
        print(f"    è­¦å‘Š: å¹´ä»½ä¸åŒ¹é…! {sched_date.year} -> {pred_date.year}")
```

## ç¯å¢ƒä¿¡æ¯

- **é¡¹ç›®è·¯å¾„**: `c:/workspace/quant_trading_system`
- **é¢„æµ‹æ•°æ®**: `artifacts/preds/preds_y5_2020_2024.parquet`
- **ç‰¹å¾æ•°æ®**: `artifacts/features_day.parquet`
- **QLibæ•°æ®**: `~/.qlib/qlib_data/us_data`
- **å›æµ‹å¼•æ“**: `backtest/engine/run_backtest.py`

## ç›¸å…³æ–‡ä»¶

- `strategies/xsecrebalance/data_preparation.py` - æ•°æ®å‡†å¤‡é€»è¾‘
- `backtest/engine/data_loader.py` - æ•°æ®åŠ è½½å’Œæ—¥æœŸæ˜ å°„
- `strategies/entry_strategies/icdf_equal_strategy.py` - ç­–ç•¥é€»è¾‘

---

**æ¯æ¬¡æ‰§è¡Œè°ƒæŸ¥åæ›´æ–°æ­¤æ–‡æ¡£ï¼Œè®°å½•æ–°çš„å‘ç°å’Œå¾…åŠäº‹é¡¹**
